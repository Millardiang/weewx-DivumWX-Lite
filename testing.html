<!doctype html>
<html lang="us">
<!-- This page takes the information provided by the client and sends them a file called services.txt which is used in the -->
<!-- installation of the Weather34 skin template on a WeeWX Personal Weather Station system. -->
<!-- Original code written by Ian Millard -->
<!-- Rewritten on Feburary 2021 by Steven Sheeley, reusing the file saving routine -->
<!-- Whilst it was attempted to maintain the look and feel of the original, all -->
<!-- html, css and javascript used in the new page is by Steven Sheeley -->
<!-- Revised in Feburary 2022 to remove old services and add new ones -->

<head>
    <title>Weather34 services.txt generator form</title>
    <meta name="description" content="This form generates the services.txt file that is needed to install the Weather34 skin and modify the weewx conf file." />
    <meta name="robots" content="noindex, nofollow">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <style>
        .container {
        display: grid;
        grid-template-columns: 60% 40%;
        grid-template-rows: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
        margin: auto;
        width: 90%;
        height: 100%;
        gap: 5px 5px;
        border: 2px solid #000000;
        background-color: #a4c8f73f;
        padding: 4px;
        border-radius: 12px;
        box-shadow: 4px 4px 8px 0px rgba(128, 0, 0, 1);
        grid-template-areas: "Header Header"
        "Map-Input Map"
        "Section1 Section1"
        "Section2 Section2"
        "Section3 Section3"
        "Checkboxes Checkboxes"
        "Submit Submit";
        }
        .Header {
        grid-area: Header;
        grid-area: Header;
        padding: 6px;
        border-radius: 12px;
        box-shadow: 3px 2px inset;
        border: 2px solid #000000;
        background-color: #ffffff;
        }
        .Map-Input {
        grid-area: Map-Input;
        border: 2px solid #000000;
        background-color: #b6ddfd;
        padding: 12px;
        border-radius: 12px;
        }
        .Map {
        grid-area: Map;
        border: 2px solid #000000;
        background-color: #b6ddfd;
        padding: 12px;
        border-radius: 12px;
        }
        #mapid {
            width: 100%;
            height: 300px;
            position: absolute;
            top: 0;
            left: 0;
        }
        .Section1 {
        grid-area: Section1;
        border: 2px solid #000000;
        background-color: #b6ddfd;
        padding: 12px;
        border-radius: 12px;
        }
        .Section2 {
        grid-area: Section2;
        border: 2px solid #000000;
        background-color: #b6ddfd;
        padding: 12px;
        border-radius: 12px;
        }
        .Section3 {
        grid-area: Section3;
        border: 2px solid #000000;
        background-color: #b6ddfd;
        padding: 12px;
        border-radius: 12px;
        }
        .Checkboxes {
        grid-area: Checkboxes;
        border: 2px solid #000000;
        background-color: #b6ddfd;
        padding: 12px;
        border-radius: 12px;
        }
        .Submit {
        grid-area: Submit;
        border: 2px solid #000000;
        background-color: #b6ddfd;
        padding: 12px;
        border-radius: 12px;
        }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
</head>
<body>
    <!-- Begin Container -->
    <div class="container">
        <div class="Header">
            <div style="text-align: center">
                <h3>Weather34 services.txt Generator</h3>
            </div>
            <div>This form is designed to create the required <b>services.txt</b> file for the WeeWX Weather34 skin installation. Fill out the form below with the requested information. Each one of the optional inputs has a Yes/No radio button. The default is <i>No</i> and the text input field is disabled. You may leave them empty if you do not have that service/information. If you want more information, there is a link you can visit for each one of them in the description. If you have a API key or an ID for one of those services, click on the <b>Yes</b> button and enter the required information. Each of the inputs also have more information available if you hover over the <b>?</b>.<br /> Once you've completed the form, click the download button. This will automatically send you the file called <i><b>settings.txt</b></i> which you can save to your default download. Then upload this to the directory where you uploaded the Weather34 tarball. Once this is complete, you are ready to do the base installation of the Weather34 Skin. <br /><br /><b>Notice: When you first enter this page, you will see a popup question on the left hand side of the webpage, near the menu button, asking of this website can access your location. <i>Don't panic!!</i> We are <b>NOT</b> tracking you. The map to the right uses a feature that, if you allow this page to do so, will scroll to your approximate location on the map and then you are able to better refine your latitude and longitude by scrolling and clicking to auto fill the text boxes below.  If you choose to not allow that, you can still drag and scroll to your location and then click to do the same thing.</b><br /></div>
            <div style="text-align: center">Notice: You can hover over the <i class="fa fa-question-circle"></i> on each entry below for additional information.</div>
            <div style="text-align: center">No data is retained on this server after the process is complete.</div>
            <div style="text-align: center"><br />Note: We have replaced the use of the DarkSky API on the Weather34 skin with AerisWeather as DarkSky is no longer accepting new API account requests.</div>
        </div>
        <div class="Map-Input">Map-Input</div>
        <div class="Map" id="mapid" style="cursor:crosshair;">Map</div>
        <div class="Section1">Section1</div>
        <div class="Section2">Section2</div>
        <div class="Section3">Section3</div>
        <div class="Checkboxes">Checkboxes</div>
        <div class="Submit">Submit</div>
    </div>
    <!-- End Container-->
    <script>
        var mymap = L.map('mapid').fitWorld();
        var txtLat = document.getElementById('txtLat');
        var txtLon = document.getElementById('txtLon');
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
            maxZoom: 22,
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' + 'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
            id: 'mapbox/streets-v11',
            tileSize: 512,
            zoomOffset: -1
        }).addTo(mymap);

        function onLocationFound(e) {
            var radius = e.accuracy / 2;
        }
        function onLocationError(e) {
            alert(e.message);
        }
        mymap.on('locationfound', onLocationFound);
        mymap.on('locationerror', onLocationError);
        mymap.locate({
            setView: true
        });
        mymap.on('click', function(e) {
            txtLat.value = +e.latlng.lat.toFixed(6);
            txtLon.value = +e.latlng.lng.toFixed(6);
        });
    </script>
</body>
</html>