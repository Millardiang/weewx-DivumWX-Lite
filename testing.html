<!doctype html>
<html lang="us">
<!-- The page take the information inputted by the client and sends them a file called services.txt which is used in the -->
<!-- installation of the Weather34 skin template on a WeeWX Personal Weather Station system. -->
<!-- Original code written by Ian Millard -->
<!-- Rewritten on Feburary 2021 by Steven Sheeley, reusing the file saving routine -->
<!-- Whilst it was attempted to maintain the look and feel of the original, all -->
<!-- html, css and javascript used in the new page is by Steven Sheeley -->

<head>
    <meta charset="utf-8">
    <title>Weather34 services.txt generator form</title>
    <meta name="description" content="This form generates the services.txt file that is needed to install the Weather34 skin and modify the weewx conf file." />
    <meta name="robots" content="noindex, nofollow">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <style>
        .container {  display: grid;
            grid-template-columns: 60% 40%;
            grid-template-rows: repeat(10, 1fr);
            margin: auto;
            gap: 5px 5px;
            grid-auto-flow: row;
            grid-template-areas:
                "Banner Banner"
                "Line-One Map"
                "Line-Two Line-Two"
                "Line-Three Line-Three"
                "Line-Four Line-Four"
                "Line-Five Line-Five"
                "Line-Six Line-Six"
                "Line-7 Line-7"
                "Services Services"
                "Submit Submit";
            width: 90%;
            height: 100%;
            border: 2px solid #000;
            border-radius: 12px;
            margin-top: 15px;
            box-shadow: 8px 8px 5px #000;
            padding: 10px;
            background-color: #e4e4e4;
        }
        .Banner { grid-area: Banner;
            border: 2px solid #000;
            border-radius: 12px;
            padding: 10px;
            background-color: #fff;
        }
        .Line-One { grid-area: Line-One;
        }
        .Map { grid-area: Map;
            border: 2px solid #000;
            border-radius: 12px;
            padding: 10px;
            background-color: #fff;
            width: 300px;
            height: 300px;
        }
        .Line-Two { grid-area: Line-Two;
        }
        .Line-Three { grid-area: Line-Three;
        }
        .Line-Four { grid-area: Line-Four;
        }
        .Line-Five { grid-area: Line-Five;
        }
        .Line-Six { grid-area: Line-Six;
        }
        .Line-7 { grid-area: Line-7;
        }
        .Submit { grid-area: Submit;
        }
        .Services { grid-area: Services;
        }
        input[type=text] {
            width: 98%;
            padding: 6px;
            border: 2px solid #ccc;
            border-radius: 4px;
        }
        select {
            font: 12px Arial;
            width: 98%;
            padding: 6px;
            border: 2px solid #ccc;
            border-radius: 4px;
        }
        label[for=text] {
            width: 98%;
            padding: 6px;
        }
        .radiogroup {
            width: auto;
        }
        .myButton {
            box-shadow: 0px 10px 14px -7px #3e7327;
            background: linear-gradient(to bottom, #77b55a 5%, #72b352 100%);
            background-color: #77b55a;
            border-radius: 4px;
            border: 1px solid #4b8f29;
            display: inline-block;
            cursor: pointer;
            color: #ffffff;
            font-family: Arial;
            font-size: 14px;
            font-weight: bold;
            padding: 10px 4px;
            text-decoration: none;
            text-shadow: 0px 1px 11px #5b8a3c;
        }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
</head>
<body>
    <!-- Begin Container -->
    <div class="container">
        <div class="Banner">
            <div style="text-align: center">
                <h3>Weather34 services.txt Generator</h3>
            </div>
            <div>This form is designed to create the required <b>services.txt</b> file for the WeeWX Weather34 skin installation. Fill out the form below with the requested information. Each one of the optional inputs has a Yes/No radio button. The default is No and the text input field is disabled. You may leave them empty if you do not have that service/information. If you want more information, there is a link you can visit for each one of them in the description. If you have a API key or an ID for one of those services, click on the <b>Yes</b> button and enter the required information. Each of the inputs also have more information available if you hover over the <b>?</b>.<br /> Once you've completed the form click the download button. This will automatically send you the file called <i><b>settings.txt</b></i> which you can save to your default download (or any) folder. Once the download is complete, copy the file to the directory that you unzipped or cloned the Weather34 files to. Once this is complete, you are ready to do the base installation of the Weather34 Skin. <br /><br /><b>Notice: When you first enter this page, you will see a popup question on the left hand side of the webpage, near the menu button, asking of this website can access your location. <i>Don't panic!!</i> We're not tracking you. The map to the right uses a feature that, if you allow this page to do so, will scroll to your approximate location on the map and then you are able to better refine your latitude and longitude by scrolling and clicking to auto fill the text boxes below.  If you choose to not allow that, you can still drag and scroll to your location and then click to do the same thing.</b></div>
            <div style="text-align: center">No data is retained on this server after the process is complete.</div>
            <div style="text-align: center"><br />Note: We have replaced the use of the DarkSky API on the Weather34 skin with AerisWeather as DarkSky is no longer accepting new API account requests.</div>
        </div>
        <div class="Line-One">
            <h3> Weather Station Location, Language and IP Address Section</h3>
            <label for="text">Latitude</label>&nbsp;<i class="fa fa-question-circle" title="Please select the location of your weather station on the map to the right by scrolling to where it's physically located and clicking on the map at that location. Your latitude and longitude will then be automatically filled out on the form to the left."></i><br />
            <input type="text" id="txtLat"><br />
            <label for="text">Longitude</label>&nbsp;<i class="fa fa-question-circle" title="Please select the location of your weather station on the map to the right by scrolling to where it's physically located and clicking on the map at that location. Your latitude and longitude will then be automatically filled out on the form to the left."></i><br />
            <input type="text" id="txtLon"><br />
            <label for="text">Language</label>&nbsp;<i class="fa fa-question-circle" title="Please select your language from the list below"></i><br />
            <select id="selLang">
                <option selected value="">-- Please Choose Your Language--</option>
                <option value="en">English</option>
                <option value="de">German</option>
                <option value="fr">French</option>
                <option value="es">Spanish</option>
                <option value="it">Italian</option>
                <option value="br">Portuguese (Br)</option>
                <option value="ru">Russian</option>
            </select><br />
            <label for="text">Local Web Server IP Address</label>&nbsp;<i class="fa fa-question-circle" title="Enter the Weather Station's Web Server IP Address"></i>
            <input type="text" id="txtAlip" />
        </div>
        <div class="Map" id="mapid">Map</div>
        <div class="Line-Two">Line 2</div>
        <div class="Line-Three">Line 3</div>
        <div class="Line-Four">Line 4</div>
        <div class="Line-Five">Line 5</div>
        <div class="Line-Six">Line 6</div>
        <div class="Line-7">Line 7</div>
        <div class="Submit">Submit</div>
        <div class="Services">Services</div>
    </div>
    <!-- End Container-->
    <script>
        var mymap = L.map('mapid').fitWorld();
        var txtLat = document.getElementById('txtLat');
        var txtLon = document.getElementById('txtLon');
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
            maxZoom: 22,
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' + 'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
            id: 'mapbox/streets-v11',
            tileSize: 512,
            zoomOffset: -1
        }).addTo(mymap);

        function onLocationFound(e) {
            var radius = e.accuracy / 2;
        }

        function onLocationError(e) {
            alert(e.message);
        }
        mymap.on('locationfound', onLocationFound);
        mymap.on('locationerror', onLocationError);
        mymap.locate({
            setView: true
        });
        mymap.on('click', function(e) {
            txtLat.value = +e.latlng.lat.toFixed(6);
            txtLon.value = +e.latlng.lng.toFixed(6);
        });
    </script>
</body>
</html>